from selenium import webdriver
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
import time

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —É–∂–µ –∑–∞–ø—É—â–µ–Ω–Ω–æ–º—É Chrome —Å remote debugging
chrome_options = Options()
chrome_options.debugger_address = "127.0.0.1:9222"
driver = webdriver.Chrome(options=chrome_options)
wait = WebDriverWait(driver, 15)

answers = [
    "–î–æ–±—Ä—ã–π –¥–µ–Ω—å. –ú—ã –∏—Å–∫—Ä–µ–Ω–Ω–µ —Ä–∞–¥—ã, —á—Ç–æ –≤–∞–º –ø–æ–Ω—Ä–∞–≤–∏–ª–∞—Å—å –Ω–∞—à–∞ –∏–≥—Ä–∞. –ë–æ–ª—å—à–æ–µ –≤–∞–º —Å–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –æ—Ç–∑—ã–≤ –∏ –æ—Ü–µ–Ω–∫—É. –ü–æ—Ö–≤–∞–ª–∞, –∫–æ—Ç–æ—Ä—É—é –º—ã –ø–æ–ª—É—á–∞–µ–º –æ—Ç –Ω–∞—à–∏—Ö –∏–≥—Ä–æ–∫–æ–≤, –ø–æ–º–æ–∂–µ—Ç –Ω–∞–º —É–ª—É—á—à–∞—Ç—å –Ω–∞—à–∏ —Ç–µ–∫—É—â–∏–µ –∏–≥—Ä—ã –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –±–æ–ª–µ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –∏–≥—Ä—ã –≤ –±—É–¥—É—â–µ–º.",
    "–î–æ–±—Ä—ã–π –¥–µ–Ω—å. –°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à—É –æ—Ü–µ–Ω–∫—É! –ù–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç –≤–∞—à –æ—Ç–∑—ã–≤. –ú—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å—Ç–∞—Ä–∞–µ–º—Å—è –¥–µ–ª–∞—Ç—å –Ω–∞—à—É –∏–≥—Ä—É –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª–µ–µ —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–π, –ø–æ—ç—Ç–æ–º—É –æ—Ç–∑—ã–≤—ã –Ω–∞—à–∏—Ö –∏–≥—Ä–æ–∫–æ–≤ –æ—á–µ–Ω—å —Ü–µ–Ω–Ω—ã –¥–ª—è –Ω–∞—Å. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º –ø–∏—Å—å–º–æ  –ø–æ –∞–¥—Ä–µ—Å—É support_gokru@mechanist.co —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º–∏. –•–æ—Ä–æ—à–µ–≥–æ –≤–∞–º –≤—Ä–µ–º–µ–Ω–∏ :)",
    "–î–æ–±—Ä—ã–π –¥–µ–Ω—å. –ù–∞—à–∞ –∏—Å–∫—Ä–µ–Ω–Ω—è—è –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å –∑–∞ –≤–∞—à—É –æ—Ü–µ–Ω–∫—É. –ü—Ä–∏—è—Ç–Ω–æ –∑–Ω–∞—Ç—å, —á—Ç–æ –≤–∞–º –ø–æ–Ω—Ä–∞–≤–∏–ª–∞—Å—å –Ω–∞—à–∞ –∏–≥—Ä–∞, —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –º–æ—Ç–∏–≤–∏—Ä—É–µ—Ç –Ω–∞—Å –Ω–∞ –¥–∞–ª—å–Ω–µ–π—à–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ. –ú—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –≤–∞—à –æ—Ç–∑—ã–≤. –°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à—É –ø–æ–¥–¥–µ—Ä–∂–∫—É!",
    "–î–æ–±—Ä—ã–π –¥–µ–Ω—å. –°–ø–∞—Å–∏–±–æ –≤–∞–º –∑–∞ –≤–∞—à –æ–±–Ω–∞–¥–µ–∂–∏–≤–∞—é—â–∏–π –æ—Ç–∑—ã–≤ –∏ –æ—Ü–µ–Ω–∫—É! –ú—ã –Ω–∞–¥–µ–µ–º—Å—è, —á—Ç–æ –≤—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ –Ω–∞—Å–ª–∞–∂–¥–∞—Ç—å—Å—è –Ω–∞—à–µ–π –∏–≥—Ä–æ–π. –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –∫–∞–∫–∏–µ-–ª–∏–±–æ –æ—Ç–∑—ã–≤—ã –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–ø–∏—à–∏—Ç–µ –≤ –Ω–∞—à—É —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫—É –≤ –∏–≥—Ä–µ –∏–ª–∏ –ø–æ –∞–¥—Ä–µ—Å—É support_gokru@mechanist.co. –ú—ã –±—É–¥–µ–º —Ä–∞–¥—ã —É—Å–ª—ã—à–∞—Ç—å –≤–∞—Å!"
]

print("–ù–∞—á–∏–Ω–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—Ç–∑—ã–≤–æ–≤...")

try:
    # –ñ–¥—ë–º –ø–æ—è–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–æ–ª–µ–π –æ—Ç–≤–µ—Ç–∞ (textarea)
    textareas = wait.until(EC.presence_of_all_elements_located((By.XPATH, '//review-reply//textarea')))
    print(f"–û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –æ—Ç–∑—ã–≤–æ–≤ –¥–ª—è –æ—Ç–≤–µ—Ç–∞: {len(textareas)}")

    for i, textarea in enumerate(textareas[:50]):
        try:
            driver.execute_script("arguments[0].scrollIntoView({block: 'center'});", textarea)
            time.sleep(0.3)

            textarea.clear()
            textarea.send_keys(answers[i % len(answers)])
            time.sleep(1.2)  # –ñ–¥—ë–º –ø–æ—è–≤–ª–µ–Ω–∏—è –∫–Ω–æ–ø–∫–∏

            # –ù–∞—Ö–æ–¥–∏–º –±–ª–æ–∫ review-reply, —Ä–æ–¥–∏—Ç–µ–ª—å textarea
            review_reply = textarea.find_element(By.XPATH, './ancestor::review-reply')

            # –ñ–¥—ë–º –∫–Ω–æ–ø–∫—É Publish reply –≤–Ω—É—Ç—Ä–∏ review-reply –∏ –∫–ª–∏–∫–∞–µ–º
            publish_btn = WebDriverWait(review_reply, 4).until(
                EC.element_to_be_clickable((
                    By.XPATH,
                    './/console-button-set/div/material-button/button'
                ))
            )
            driver.execute_script("arguments[0].click();", publish_btn)

            print(f"[{i+1}] ‚úÖ –û—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω.")
            time.sleep(1.2)

        except Exception as e:
            print(f"[{i+1}] ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–≤–µ—Ç–µ: {e}")
            continue

except Exception as e:
    print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: {e}")

finally:
    print("üèÅ –†–∞–±–æ—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞.")

